{{define "agenda"}}
<!DOCTYPE html>
<html lang="en">
    {{template "html-head" printf "Decred Vote Agenda Pages"}}
    <body>
        {{template "navbar" .}}
        {{with .Ai}}
        <div class="container">
            <div class="row justify-content-between">
                <div class="col-md-7 col-sm-6 d-flex">
                    <h4 class="mb-2">{{.Id}}
                    </h4>
                </div>
            </div>
            <div class="row justify-content-between">
                <div class="col-md-7 col-sm-6 d-flex">
                    <table class="">
                        <tr>
                            <td class="text-right pr-2 lh1rem vam nowrap xs-w117">Description</td>
                            <td>
                                <span class="hash break-word  lh1rem">{{.Description}}</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="text-right pr-2 lh1rem vam nowrap xs-w117">Mask</td>
                            <td>
                                <span class="hash break-word  lh1rem">{{.Mask}}</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="text-right pr-2 lh1rem vam nowrap xs-w117">StartTime</td>
                            <td>
                                <span class="hash break-word  lh1rem">{{TimeConvertion .StartTime}}</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="text-right pr-2 lh1rem vam nowrap xs-w117">ExpireTime</td>
                            <td>
                                <span class="hash break-word  lh1rem">{{TimeConvertion .ExpireTime}}</span>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="col-md-5 col-sm-6 d-flex">
                    <table class="">
                        <tr>
                            <td class="text-right lh1rem pr-2 xs-w117">Status</td>
                            <td class="lh1rem" style="min-width: 178px;">
                                <span class="hash break-word  lh1rem">{{.Status}}</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="text-right lh1rem pr-2 xs-w117">QuorumProgress</td>
                            <td class="lh1rem" style="min-width: 178px;">
                                <span class="hash break-word  lh1rem">{{.QuorumProgress}}</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="text-right lh1rem pr-2 xs-w117">VoteVersion</td>
                            <td class="lh1rem" style="min-width: 178px;">
                                <span class="hash break-word  lh1rem">{{.VoteVersion}}</span>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            {{if .Choices}}
            <table class="table table-mono-cells table-sm striped">
                <thead>
                    <th>ID</th>
                    <th>Description</th>
                    <th>Bits</th>
                    <th>IsAbstain</th>
                    <th>IsNo</th>
                    <th>Count</th>
                    <th>Progress</th>
                </thead>
                {{range $i, $v := .Choices}}
                {{with $v}}
                <thead>
                    <tr>
                        <td class="text-left">{{.Id}}</td>
                        <td class="text-left">{{.Description}}</td>
                        <td class="text-left">{{.Bits}}</td>
                        <td class="text-left">{{.IsAbstain}}</td>
                        <td class="text-left">{{.IsNo}}</td>
                        <td class="text-left">{{.Count}}</td>
                        <td class="text-left">{{.Progress}}</td>
                    </tr>
                </thead>
                {{end}}
                {{end}}
            </table>
            {{end}}

            <table>
                <tr>
                    <td>
                        <div id="lineGraph" style="width:900px; height:450px; margin:0 auto;"></div>
                    </td>
                    <td>
                        <canvas id="doughnutGraph" class="doughnutGraph" width="200" height="200"
             chart-options="{tooltipTemplate: '<%=label%>: <%= numeral(value).format('($00[.]00)') %> - <%= numeral(circumference / 6.283).format('(0[.][00]%)') %>'">
                   </canvas>
                    </td>
                </tr>
            </table>
            </div>
        </div>
        {{end}}

        <style type="text/css">
         .dygraph-legend {
           padding: 4px !important;
           border: 1px solid #000;
           border-radius: 5px;
           pointer-events: none;
           width: fit-content;
         }
         .dygraph-rangesel-bgcanvas {
           z-index: 0 !important;
         }
         .dygraph-rangesel-fgcanvas {
           z-index: 0 !important;
         }
         .dygraph-rangesel-zoomhandle {
           z-index: 0 !important;
         }
         .dygraph-axis-label {
           z-index: 0 !important;
         }
        .doughnutGraph {
            float: right;
        }
       </style>

        <script>
        var v = {{.TotalVotes}}
        var chart = {{.ChartData}}

        var d = ""
        chart.map(function(n){
            d = d + n.time + ", " + n.total + ", " + n.abstain + ", "+ n.yes + ", " + n.no +  " \n"
        });

        new Dygraph(
            document.getElementById("lineGraph"),
            d,
            {
                labels: ["Date", "Total Votes",  "Abstain", "Yes", "No"],
                showRangeSelector: true,
                ylabel: 'Vote Choices Cast',
                legend: 'follow',
                colors: ['blue', 'orange', 'rgb(0,153,0)', 'red'],
                labelsSeparateLines: true
            }
        );

        new Chart(
            document.getElementById("doughnutGraph"), {
            options: {
                width:200,
                height:200,
                responsive: false, 
                animation: { animateScale: true },
                legend: {
                    position: 'bottom',
                    },
                title: {
                    display: true,
                    text: 'Total Votes Tally'
                },
                tooltips: {
                    callbacks: {
                        label: function(tooltipItem, data) {
                        var dataset = data.datasets[tooltipItem.datasetIndex];
                        var currentValue = dataset.data[tooltipItem.index];
                        var precentage = (currentValue/v.total) * 100;
                        return currentValue + " Votes ( " + precentage.toFixed(2) + "% )";
                        }
                    }
                  } 

                },
            type: "doughnut",
            data: {
                labels: ["Abstain", "No", "Yes"],
                datasets: [{
                    data: [v.abstain, v.no, v.yes,],
                    label: 'abstained votes',
                    backgroundColor: ['orange', 'red', 'rgb(0,153,0)'],
                    borderColor: [ 'white', 'white', 'white'],
                    borderWidth: 0.5
                }]
            }
        });

        </script>
        {{template "footer" . }}
    </body>
</html>
{{end}}